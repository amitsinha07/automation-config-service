meta:
  domain: ONDC:RET13
  version: 1.2.0
  flowId: Search_and_Custom_Menu_(Incremental_Push)
transaction_data:
  transaction_id: 7bff96fb-28c1-4b0f-82b0-c6e13beb0cfc
  latest_timestamp: '1970-01-01T00:00:00.000Z'
  bap_id: sample-bap-id
  bap_uri: https://bap.example.com
  bpp_id: sample-bpp-id
  bpp_uri: https://bpp.example.com
steps:
  - api: search
    action_id: search_inc
    owner: BAP
    responseFor: null
    unsolicited: false
    description: Bap starts search for incremental changes
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBpZiAoc2Vzc2lvbkRhdGEuaW5jX21vZGUpIHsKICAgIGRlZmF1bHRQYXlsb2FkLm1lc3NhZ2UuaW50ZW50LnRhZ3NbMF0ubGlzdFswXS52YWx1ZSA9ICJzdG9wIjsKICB9CiAgZGVmYXVsdFBheWxvYWQuY29udGV4dC5jaXR5ID0gIioiOwogIAogIHJldHVybiBkZWZhdWx0UGF5bG9hZDsKfQ==
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: ONDC:RET13
          action: search
          timestamp: '2026-01-20T09:05:17.039Z'
          transaction_id: 7bff96fb-28c1-4b0f-82b0-c6e13beb0cfc
          message_id: b00ce1b2-b91d-4634-931e-7822bb0cd34c
          bap_id: sample-bap-id
          bap_uri: https://bap.example.com
          ttl: PT30S
          country: IND
          city: '*'
          core_version: 1.2.0
        message:
          intent:
            payment:
              '@ondc/org/buyer_app_finder_fee_type': percent
              '@ondc/org/buyer_app_finder_fee_amount': '3'
            tags:
              - code: catalog_inc
                list:
                  - code: mode
                    value: start
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
        inc_mode: $.message.intent.tags[0].list[0].value
      inputs: {}
  - api: on_search
    action_id: on_search_inc
    owner: BPP
    responseFor: null
    unsolicited: true
    description: BPP returns the incremental changes
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICBkZWZhdWx0UGF5bG9hZC5jb250ZXh0LmNpdHkgPSAiKiI7CiAgZGVmYXVsdFBheWxvYWQgPSB1cGRhdGVUaW1lc3RhbXBzKGRlZmF1bHRQYXlsb2FkKTsKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: ONDC:RET13
          action: on_search
          timestamp: '2026-01-20T10:27:04.570Z'
          transaction_id: 7bff96fb-28c1-4b0f-82b0-c6e13beb0cfc
          message_id: 6a02cb20-722c-433e-ab13-da8621f5aaa6
          bap_id: sample-bap-id
          bap_uri: https://bap.example.com
          ttl: PT30S
          bpp_id: sample-bpp-id
          bpp_uri: https://bpp.example.com
          country: IND
          city: '*'
          core_version: 1.2.0
        message:
          catalog:
            bpp/providers:
              - id: P1
                items:
                  - id: I1
                    time:
                      label: enable
                      timestamp: '2023-06-03T07:30:00.000Z'
                    descriptor:
                      name: Kesh King Ayurvedic Hair Oil
                      code: 1:XXXXXXXXXXXXX
                      symbol: https://sellerNP.com/images/i1.png
                      short_desc: Kesh King Ayurvedic Hair Oil
                      long_desc: Kesh King Ayurvedic Hair Oil
                      images:
                        - https://sellerNP.com/images/i1.png
                    quantity:
                      unitized:
                        measure:
                          unit: millilitre
                          value: '300'
                      available:
                        count: '20'
                      maximum:
                        count: '10'
                    price:
                      currency: INR
                      value: '300.00'
                      maximum_value: '349.0'
                    category_id: Hair Care - Shampoo, Oils, Conditioners
                    fulfillment_id: F1
                    location_id: L1
                    '@ondc/org/returnable': true
                    '@ondc/org/cancellable': true
                    '@ondc/org/return_window': P7D
                    '@ondc/org/seller_pickup_return': true
                    '@ondc/org/time_to_ship': P1D
                    '@ondc/org/available_on_cod': false
                    '@ondc/org/contact_details_consumer_care': Ramesh,info@keshking.com,18001035155
                    '@ondc/org/statutory_reqs_packaged_commodities':
                      manufacturer_or_packer_name: Emami Ltd
                      manufacturer_or_packer_address: Emami Ltd., 687 Anandapur, Kolkata 700107
                      common_or_generic_name_of_commodity: Hair Oil
                      month_year_of_manufacture_packing_import: 06/2023
                    tags:
                      - code: origin
                        list:
                          - code: country
                            value: IND
                      - code: image
                        list:
                          - code: type
                            value: back_image
                          - code: url
                            value: https://sellerNP.com/images/i1_back_image.png
                      - code: attribute
                        list:
                          - code: brand
                            value: Kesh King
                          - code: colour
                            value: '#000000'
                          - code: colour_name
                            value: Black
                          - code: gender
                            value: male
                          - code: concern
                            value: tangled_hair
                          - code: ingredient
                            value: neem
                          - code: conscious
                            value: natural
                          - code: preference
                            value: herbal
                          - code: formulation
                            value: liquid
                          - code: skin_type
                            value: normal
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
      inputs: {}
  - api: on_search
    action_id: on_search_inc_close
    owner: BPP
    responseFor: null
    unsolicited: true
    description: please add relevant description
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKCWRlZmF1bHRQYXlsb2FkID0gdXBkYXRlVGltZXN0YW1wcyhkZWZhdWx0UGF5bG9hZCk7CiAgcmV0dXJuIGRlZmF1bHRQYXlsb2FkOwp9
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: ONDC:RET13
          action: on_search
          timestamp: '2026-01-21T06:31:01.772Z'
          transaction_id: 7bff96fb-28c1-4b0f-82b0-c6e13beb0cfc
          message_id: 66bf003d-d761-4a00-9162-6633e64f8ea7
          bap_id: sample-bap-id
          bap_uri: https://bap.example.com
          ttl: PT30S
          bpp_id: sample-bpp-id
          bpp_uri: https://bpp.example.com
          country: IND
          city: '*'
          core_version: 1.2.0
        message:
          catalog:
            bpp/providers:
              - id: P1
                locations:
                  - id: L1
                    time:
                      label: disable
                      timestamp: '2025-01-08T10:20:00.000Z'
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
      inputs: {}
  - api: search
    action_id: search_inc1
    owner: BAP
    responseFor: null
    unsolicited: false
    description: Bap stops search for incremental changes
    mock:
      generate: >-
        LyoqCiAqIEdlbmVyYXRlcyB0aGUgbW9jayBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogVGhpcyBmdW5jdGlvbiBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgZGVmYXVsdCBwYXlsb2FkIHVzaW5nIHNlc3Npb24gZGF0YQogKiBmcm9tIHByZXZpb3VzIHN0ZXBzIGFuZCB1c2VyIGlucHV0cy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0UGF5bG9hZCAtIFRoZSBiYXNlIHBheWxvYWQgb2JqZWN0IHdpdGggY29udGV4dCBhbHJlYWR5IHBvcHVsYXRlZC4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhLnVzZXJfaW5wdXRzIC0gVXNlci1wcm92aWRlZCBpbnB1dCB2YWx1ZXMgZm9yIHRoaXMgc3RlcC4KICogQHBhcmFtIHsqfSBzZXNzaW9uRGF0YS5ba2V5XSAtIEFueSBzYXZlZCBkYXRhIGZyb20gcHJldmlvdXMgc3RlcHMgKGRlZmluZWQgaW4gc2F2ZURhdGEgY29uZmlnKS4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBnZW5lcmF0ZWQgcGF5bG9hZCBvYmplY3QgdG8gYmUgc2VudCBpbiB0aGUgQVBJIHJlcXVlc3QuCiAqLwphc3luYyBmdW5jdGlvbiBnZW5lcmF0ZShkZWZhdWx0UGF5bG9hZCwgc2Vzc2lvbkRhdGEpIHsKICByZXR1cm4gZGVmYXVsdFBheWxvYWQ7Cn0=
      validate: >-
        LyoqCiAqIFZhbGlkYXRlcyB0aGUgaW5jb21pbmcgcmVxdWVzdCBwYXlsb2FkIGZvciBhbiBBUEkgY2FsbCBpbiB0aGUgdHJhbnNhY3Rpb24gZmxvdy4KICogCiAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRQYXlsb2FkIC0gVGhlIGluY29taW5nIHJlcXVlc3QgcGF5bG9hZCB0byB2YWxpZGF0ZS4KICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gRGF0YSBjb2xsZWN0ZWQgZnJvbSBwcmV2aW91cyB0cmFuc2FjdGlvbiBzdGVwcy4KICogCiAqIEByZXR1cm5zIHtPYmplY3R9IHsgdmFsaWQ6IGJvb2xlYW4sIGNvZGU6IG51bWJlciwgZGVzY3JpcHRpb246IHN0cmluZyB9CiAqLwpmdW5jdGlvbiB2YWxpZGF0ZSh0YXJnZXRQYXlsb2FkLCBzZXNzaW9uRGF0YSkgewogIHJldHVybiB7IHZhbGlkOiB0cnVlLCBjb2RlOiAyMDAsIGRlc2NyaXB0aW9uOiAiVmFsaWQgcmVxdWVzdCIgfTsKfQ==
      requirements: >-
        LyoqCiAqIENoZWNrcyBpZiB0aGUgcmVxdWlyZW1lbnRzIGZvciBwcm9jZWVkaW5nIHdpdGggdGhlIEFQSSBjYWxsIGFyZSBtZXQuCiAqIAogKiBAcGFyYW0ge09iamVjdH0gc2Vzc2lvbkRhdGEgLSBEYXRhIGNvbGxlY3RlZCBmcm9tIHByZXZpb3VzIHRyYW5zYWN0aW9uIHN0ZXBzLgogKiAKICogQHJldHVybnMge09iamVjdH0geyB2YWxpZDogYm9vbGVhbiwgY29kZTogbnVtYmVyLCBkZXNjcmlwdGlvbjogc3RyaW5nIH0KICovCmZ1bmN0aW9uIG1lZXRzUmVxdWlyZW1lbnRzKHNlc3Npb25EYXRhKSB7CiAgcmV0dXJuIHsgdmFsaWQ6IHRydWUsIGNvZGU6IDIwMCwgZGVzY3JpcHRpb246ICJSZXF1aXJlbWVudHMgbWV0IiB9Owp9
      defaultPayload:
        context:
          domain: ONDC:RET13
          action: search
          timestamp: '2026-01-21T07:04:52.209Z'
          transaction_id: 7bff96fb-28c1-4b0f-82b0-c6e13beb0cfc
          message_id: cf8ad8f5-da54-4f86-87d5-1ec92141f823
          bap_id: sample-bap-id
          bap_uri: https://bap.example.com
          ttl: PT30S
          country: IND
          city: '*'
          core_version: 1.2.0
        message:
          intent:
            payment:
              '@ondc/org/buyer_app_finder_fee_type': percent
              '@ondc/org/buyer_app_finder_fee_amount': '3'
            tags:
              - code: catalog_inc
                list:
                  - code: mode
                    value: stop
      saveData:
        transactionId: $.context.transaction_id
        latestMessage_id: $.context.message_id
        latestTimestamp: $.context.timestamp
        bapId: $.context.bap_id
        bapUri: $.context.bap_uri
        bppId: $.context.bpp_id
        bppUri: $.context.bpp_uri
      inputs: {}
transaction_history:
  - action_id: search_inc
    payload:
      context:
        domain: ONDC:RET13
        action: search
        timestamp: '2026-02-23T09:57:47.025Z'
        transaction_id: 7bff96fb-28c1-4b0f-82b0-c6e13beb0cfc
        message_id: 4fd396ed-dfe4-4160-b632-6828aaa7a3d0
        bap_id: sample-bap-id
        bap_uri: https://bap.example.com
        ttl: PT30S
        country: IND
        city: '*'
        core_version: 1.2.0
      message:
        intent:
          payment:
            '@ondc/org/buyer_app_finder_fee_type': percent
            '@ondc/org/buyer_app_finder_fee_amount': '3'
          tags:
            - code: catalog_inc
              list:
                - code: mode
                  value: start
    action: search
    saved_info: {}
  - action_id: on_search_inc
    payload:
      context:
        domain: ONDC:RET13
        action: on_search
        timestamp: '2026-02-23T09:57:47.047Z'
        transaction_id: 7bff96fb-28c1-4b0f-82b0-c6e13beb0cfc
        message_id: bead30d9-1150-481c-ada4-2177c5fc51b6
        bap_id: sample-bap-id
        bap_uri: https://bap.example.com
        ttl: PT30S
        bpp_id: sample-bpp-id
        bpp_uri: https://bpp.example.com
        country: IND
        city: '*'
        core_version: 1.2.0
      message:
        catalog:
          bpp/providers:
            - id: P1
              items:
                - id: I1
                  time:
                    label: enable
                    timestamp: '2026-02-23T09:57:47.047Z'
                  descriptor:
                    name: Kesh King Ayurvedic Hair Oil
                    code: 1:XXXXXXXXXXXXX
                    symbol: https://sellerNP.com/images/i1.png
                    short_desc: Kesh King Ayurvedic Hair Oil
                    long_desc: Kesh King Ayurvedic Hair Oil
                    images:
                      - https://sellerNP.com/images/i1.png
                  quantity:
                    unitized:
                      measure:
                        unit: millilitre
                        value: '300'
                    available:
                      count: '20'
                    maximum:
                      count: '10'
                  price:
                    currency: INR
                    value: '300.00'
                    maximum_value: '349.0'
                  category_id: Hair Care - Shampoo, Oils, Conditioners
                  fulfillment_id: F1
                  location_id: L1
                  '@ondc/org/returnable': true
                  '@ondc/org/cancellable': true
                  '@ondc/org/return_window': P7D
                  '@ondc/org/seller_pickup_return': true
                  '@ondc/org/time_to_ship': P1D
                  '@ondc/org/available_on_cod': false
                  '@ondc/org/contact_details_consumer_care': Ramesh,info@keshking.com,18001035155
                  '@ondc/org/statutory_reqs_packaged_commodities':
                    manufacturer_or_packer_name: Emami Ltd
                    manufacturer_or_packer_address: Emami Ltd., 687 Anandapur, Kolkata 700107
                    common_or_generic_name_of_commodity: Hair Oil
                    month_year_of_manufacture_packing_import: 06/2023
                  tags:
                    - code: origin
                      list:
                        - code: country
                          value: IND
                    - code: image
                      list:
                        - code: type
                          value: back_image
                        - code: url
                          value: https://sellerNP.com/images/i1_back_image.png
                    - code: attribute
                      list:
                        - code: brand
                          value: Kesh King
                        - code: colour
                          value: '#000000'
                        - code: colour_name
                          value: Black
                        - code: gender
                          value: male
                        - code: concern
                          value: tangled_hair
                        - code: ingredient
                          value: neem
                        - code: conscious
                          value: natural
                        - code: preference
                          value: herbal
                        - code: formulation
                          value: liquid
                        - code: skin_type
                          value: normal
    action: on_search
    saved_info: {}
  - action_id: on_search_inc_close
    payload:
      context:
        domain: ONDC:RET13
        action: on_search
        timestamp: '2026-02-23T09:57:47.057Z'
        transaction_id: 7bff96fb-28c1-4b0f-82b0-c6e13beb0cfc
        message_id: 6b97a1cf-718a-4b95-92b4-affab109cc43
        bap_id: sample-bap-id
        bap_uri: https://bap.example.com
        ttl: PT30S
        bpp_id: sample-bpp-id
        bpp_uri: https://bpp.example.com
        country: IND
        city: '*'
        core_version: 1.2.0
      message:
        catalog:
          bpp/providers:
            - id: P1
              locations:
                - id: L1
                  time:
                    label: disable
                    timestamp: '2026-02-23T09:57:47.057Z'
    action: on_search
    saved_info: {}
  - action_id: search_inc1
    payload:
      context:
        domain: ONDC:RET13
        action: search
        timestamp: '2026-02-23T09:57:47.058Z'
        transaction_id: 7bff96fb-28c1-4b0f-82b0-c6e13beb0cfc
        message_id: a3fe3902-eee7-4682-a106-0d4c188be7cc
        bap_id: sample-bap-id
        bap_uri: https://bap.example.com
        ttl: PT30S
        country: IND
        city: '*'
        core_version: 1.2.0
      message:
        intent:
          payment:
            '@ondc/org/buyer_app_finder_fee_type': percent
            '@ondc/org/buyer_app_finder_fee_amount': '3'
          tags:
            - code: catalog_inc
              list:
                - code: mode
                  value: stop
    action: search
    saved_info: {}
validationLib: ''
helperLib: >-
  CmNvbnN0IFJFVDEwR1JPQ0VSWTEyNUNhdGFsb2cgPSBKU09OLnBhcnNlKAogIEpTT04uc3RyaW5naWZ5KHsKICAgIGNhdGFsb2c6IHsKICAgICAgImJwcC9mdWxmaWxsbWVudHMiOiBbCiAgICAgICAgeyBpZDogIkYxIiwgdHlwZTogIkRlbGl2ZXJ5IiB9LAogICAgICAgIHsgaWQ6ICJGMiIsIHR5cGU6ICJTZWxmLVBpY2t1cCIgfSwKICAgICAgICB7IGlkOiAiRjMyODIyIiwgdHlwZTogIkJ1eWVyLURlbGl2ZXJ5IiB9CiAgICAgIF0sCiAgICAgICJicHAvZGVzY3JpcHRvciI6IHsKICAgICAgICBuYW1lOiAiTW9jayBTZWxsZXIgTlAiLAogICAgICAgIHN5bWJvbDogImh0dHBzOi8vc2VsbGVyTlAuY29tL2ltYWdlcy9ucC5wbmciLAogICAgICAgIHNob3J0X2Rlc2M6ICJTZWxsZXIgTWFya2V0cGxhY2UiLAogICAgICAgIGxvbmdfZGVzYzogIlNlbGxlciBNYXJrZXRwbGFjZSIsCiAgICAgICAgaW1hZ2VzOiBbImh0dHBzOi8vc2VsbGVyTlAuY29tL2ltYWdlcy9ucC5wbmciXSwKICAgICAgICB0YWdzOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvZGU6ICJicHBfdGVybXMiLAogICAgICAgICAgICBsaXN0OiBbeyBjb2RlOiAibnBfdHlwZSIsIHZhbHVlOiAiTVNOIiB9XQogICAgICAgICAgfQogICAgICAgIF0KICAgICAgfSwKICAgICAgImJwcC9wcm92aWRlcnMiOiBbCiAgICAgICAgewogICAgICAgICAgdGltZTogewogICAgICAgICAgICBsYWJlbDogImVuYWJsZSIsCiAgICAgICAgICAgIHRpbWVzdGFtcDogIjIwMjQtMTItMjNUMDY6NTU6NDUuMDM1WiIKICAgICAgICAgIH0sCiAgICAgICAgICBkZXNjcmlwdG9yOiB7CiAgICAgICAgICAgIG5hbWU6ICJTdG9yZSAxIiwKICAgICAgICAgICAgc3ltYm9sOiAiaHR0cHM6Ly9zZWxsZXJOUC5jb20vaW1hZ2VzL3N0b3JlMS5wbmciLAogICAgICAgICAgICBzaG9ydF9kZXNjOiAiU3RvcmUgMSIsCiAgICAgICAgICAgIGxvbmdfZGVzYzogIlN0b3JlIDEiLAogICAgICAgICAgICBpbWFnZXM6IFsiaHR0cHM6Ly9zZWxsZXJOUC5jb20vaW1hZ2VzL3N0b3JlMS5wbmciXQogICAgICAgICAgfSwKICAgICAgICAgIHR0bDogIlAxRCIsCiAgICAgICAgICBsb2NhdGlvbnM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIGlkOiAiTDEiLAogICAgICAgICAgICAgIHRpbWU6IHsKICAgICAgICAgICAgICAgIGxhYmVsOiAiZW5hYmxlIiwKICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogIjIwMjQtMTItMjNUMDY6NTU6NDUuMDM1WiIsCiAgICAgICAgICAgICAgICBkYXlzOiAiMSwyLDMsNCw1LDYsNyIsCiAgICAgICAgICAgICAgICBzY2hlZHVsZTogeyBob2xpZGF5czogW10gfSwKICAgICAgICAgICAgICAgIHJhbmdlOiB7IHN0YXJ0OiAiMDAwMCIsIGVuZDogIjIzNTkiIH0KICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGdwczogIjE5LjEyOTA3Niw3Mi44MjU4MDMiLAogICAgICAgICAgICAgIGFkZHJlc3M6IHsKICAgICAgICAgICAgICAgIHN0cmVldDogIjEgJiAyLEFNQVIgSllPVEkgQ0hTLkJMREcuLE9QUC5OQU5EIEtSSVBBIEhBTEwiLAogICAgICAgICAgICAgICAgbG9jYWxpdHk6ICJBTkRIRVJJIEZPVVIgQlVOR0xPVyBBTUFSIEpZT1RJIENIUyIsCiAgICAgICAgICAgICAgICBjaXR5OiAibW9jay1zZWxsZXItY2l0eSIsCiAgICAgICAgICAgICAgICBzdGF0ZTogIm1vY2stc3RhdGUiLAogICAgICAgICAgICAgICAgYXJlYV9jb2RlOiAiNDAwMDUzIgogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgY2lyY2xlOiB7CiAgICAgICAgICAgICAgICBncHM6ICIxOS4xMjkwNzYsNzIuODI1ODAzIiwKICAgICAgICAgICAgICAgIHJhZGl1czogeyB1bml0OiAia20iLCB2YWx1ZTogIjMiIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBmdWxmaWxsbWVudHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIGlkOiAiRjEiLAogICAgICAgICAgICAgIHR5cGU6ICJEZWxpdmVyeSIsCiAgICAgICAgICAgICAgY29udGFjdDogeyBwaG9uZTogIjk1OTQ2NjM3MTAiLCBlbWFpbDogIm5vYm9keUBub21haWwuY29tIiB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBpZDogIkYyIiwKICAgICAgICAgICAgICB0eXBlOiAiU2VsZi1QaWNrdXAiLAogICAgICAgICAgICAgIGNvbnRhY3Q6IHsgcGhvbmU6ICI5NTk0NjYzOTk5IiwgZW1haWw6ICJtb2NrQG5vbWFpbC5jb20iIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIGlkOiAiRjMyODIyIiwKICAgICAgICAgICAgICB0eXBlOiAiQnV5ZXItRGVsaXZlcnkiLAogICAgICAgICAgICAgIGNvbnRhY3Q6IHsgcGhvbmU6ICI5NTk0NjYzODg4IiwgZW1haWw6ICJtb2NrMkBub21haWwuY29tIiB9CiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICBpdGVtczogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgZGVzY3JpcHRvcjogewogICAgICAgICAgICAgICAgbmFtZTogIlBsYWluIEF0dGEiLAogICAgICAgICAgICAgICAgY29kZTogIjE6OTc4MDIwMTM3OTYyIiwKICAgICAgICAgICAgICAgIHN5bWJvbDogImh0dHBzOi8vc2VsbGVyTlAuY29tL2ltYWdlcy9pMS5wbmciLAogICAgICAgICAgICAgICAgc2hvcnRfZGVzYzogIlBsYWluIEF0dGEiLAogICAgICAgICAgICAgICAgbG9uZ19kZXNjOiAiUGxhaW4gQXR0YSIsCiAgICAgICAgICAgICAgICBpbWFnZXM6IFsiaHR0cHM6Ly9zZWxsZXJOUC5jb20vaW1hZ2VzL2kxLnBuZyJdCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBwcmljZTogewogICAgICAgICAgICAgICAgY3VycmVuY3k6ICJJTlIiLAogICAgICAgICAgICAgICAgdmFsdWU6ICIyMDAuMDAiLAogICAgICAgICAgICAgICAgbWF4aW11bV92YWx1ZTogIjIwMC4wMCIKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHF1YW50aXR5OiB7CiAgICAgICAgICAgICAgICB1bml0aXplZDogewogICAgICAgICAgICAgICAgICBtZWFzdXJlOiB7IHVuaXQ6ICJraWxvZ3JhbSIsIHZhbHVlOiAiMyIgfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGF2YWlsYWJsZTogeyBjb3VudDogIjk5IiB9LAogICAgICAgICAgICAgICAgbWF4aW11bTogeyBjb3VudDogIjk5IiB9CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBjYXRlZ29yeV9pZDogIkF0dGEsIEZsb3VycyBhbmQgU29vamkiLAogICAgICAgICAgICAgIGZ1bGZpbGxtZW50X2lkOiAiRjEiLAogICAgICAgICAgICAgIGxvY2F0aW9uX2lkOiAiTDEiLAogICAgICAgICAgICAgICJAb25kYy9vcmcvcmV0dXJuYWJsZSI6IHRydWUsCiAgICAgICAgICAgICAgIkBvbmRjL29yZy9jYW5jZWxsYWJsZSI6IHRydWUsCiAgICAgICAgICAgICAgIkBvbmRjL29yZy9yZXR1cm5fd2luZG93IjogIlA3RCIsCiAgICAgICAgICAgICAgIkBvbmRjL29yZy9zZWxsZXJfcGlja3VwX3JldHVybiI6IGZhbHNlLAogICAgICAgICAgICAgICJAb25kYy9vcmcvdGltZV90b19zaGlwIjogIlBUNU0iLAogICAgICAgICAgICAgICJAb25kYy9vcmcvYXZhaWxhYmxlX29uX2NvZCI6IHRydWUsCiAgICAgICAgICAgICAgIkBvbmRjL29yZy9jb250YWN0X2RldGFpbHNfY29uc3VtZXJfY2FyZSI6CiAgICAgICAgICAgICAgICAiUmFtZXNoLHJhbWVzaEBhYmMuY29tLDE4MDA0MjU0NDQ0IiwKICAgICAgICAgICAgICAiQG9uZGMvb3JnL3N0YXR1dG9yeV9yZXFzX3BhY2thZ2VkX2NvbW1vZGl0aWVzIjogewogICAgICAgICAgICAgICAgbWFudWZhY3R1cmVyX29yX3BhY2tlcl9uYW1lOiAiSVRDIiwKICAgICAgICAgICAgICAgIG1hbnVmYWN0dXJlcl9vcl9wYWNrZXJfYWRkcmVzczoKICAgICAgICAgICAgICAgICAgIklUQyBRdWFsaXR5IENhcmUgQ2VsbCxQLk8gQm94IE5vLjU5MixCYW5nYWxvcmUtNTYwMDA1IiwKICAgICAgICAgICAgICAgIGNvbW1vbl9vcl9nZW5lcmljX25hbWVfb2ZfY29tbW9kaXR5OiAiQXNoaXJ3YWQgQXR0YSIsCiAgICAgICAgICAgICAgICBtb250aF95ZWFyX29mX21hbnVmYWN0dXJlX3BhY2tpbmdfaW1wb3J0OiAiMDEvMjAyMyIKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHRpbWU6IHsKICAgICAgICAgICAgICAgIGxhYmVsOiAiZW5hYmxlIiwKICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogIjIwMjQtMTItMjNUMDY6NTU6NDUuMDM1WiIKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHRhZ3M6IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgY29kZTogIm9yaWdpbiIsCiAgICAgICAgICAgICAgICAgIGxpc3Q6IFt7IGNvZGU6ICJjb3VudHJ5IiwgdmFsdWU6ICJJTkQiIH1dCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICBpZDogIkkxIiwKICAgICAgICAgICAgICBwYXJlbnRfaXRlbV9pZDogIlYxIgogICAgICAgICAgICB9CiAgICAgICAgICBdLAogICAgICAgICAgaWQ6ICJQMSIKICAgICAgICB9CiAgICAgIF0KICAgIH0KICB9KQopOwoKZnVuY3Rpb24gdXBkYXRlVGltZXN0YW1wcyhvYmopIHsKICAgIGNvbnN0IGN1cnJlbnRUaW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7CiAgICAKICAgIGZ1bmN0aW9uIHJlY3Vyc2l2ZVVwZGF0ZShjdXJyZW50KSB7CiAgICAgICAgaWYgKHR5cGVvZiBjdXJyZW50ICE9PSAnb2JqZWN0JyB8fCBjdXJyZW50ID09PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gY3VycmVudCkgewogICAgICAgICAgICBpZiAoa2V5ID09PSAndGltZXN0YW1wJyAmJiB0eXBlb2YgY3VycmVudFtrZXldID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgY3VycmVudFtrZXldID0gY3VycmVudFRpbWVzdGFtcDsKICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgY3VycmVudFtrZXldID09PSAnb2JqZWN0JykgewogICAgICAgICAgICAgICAgcmVjdXJzaXZlVXBkYXRlKGN1cnJlbnRba2V5XSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKICAgIHJlY3Vyc2l2ZVVwZGF0ZShvYmopOwogICAgcmV0dXJuIG9iajsKfQoKCg==
